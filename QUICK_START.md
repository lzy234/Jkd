# 快速开始指南

## 第一步：安装依赖

双击运行 `install.bat` 文件，或在命令行中运行：
```
npm install
```

如果遇到PowerShell执行策略问题，可以：
1. 以管理员身份运行PowerShell
2. 执行：`Set-ExecutionPolicy RemoteSigned`
3. 或者直接双击 `install.bat` 文件

## 第二步：启动开发服务器

双击运行 `start.bat` 文件，或在命令行中运行：
```
npm start
```

服务器将在 https://localhost:3000 启动

## 第三步：在Excel中加载插件

### 方法一：使用共享文件夹（推荐开发时使用）

1. 打开Excel
2. 文件 -> 选项 -> 信任中心 -> 信任中心设置
3. 受信任的加载项目录 -> 添加本项目的根目录路径
4. 重启Excel
5. 插入 -> 我的加载项 -> 共享文件夹
6. 选择"订单管理插件"

### 方法二：旁加载（Sideload）

1. 确保开发服务器正在运行
2. 在Excel中：插入 -> 我的加载项 -> 上传我的加载项
3. 选择项目根目录下的 `manifest.xml` 文件
4. 点击上传

## 第四步：使用插件

1. 在Excel功能区找到"订单管理"选项卡
2. 点击"打开订单管理"按钮
3. 在右侧任务窗格中登录
4. 选择订单状态和筛选条件
5. 点击"获取订单"加载数据
6. 直接在Excel表格中编辑备注或派送人
7. 修改会自动同步到服务器

## 常见问题

### Q: 提示证书不受信任
A: 这是因为开发环境使用的是自签名HTTPS证书。在浏览器中访问 https://localhost:3000，点击"高级" -> "继续访问"，信任该证书。

### Q: 加载项无法显示
A: 
1. 确认开发服务器正在运行
2. 检查manifest.xml中的URL是否正确
3. 清除Office缓存后重试

### Q: 无法登录
A: 
1. 检查网络连接
2. 打开浏览器开发者工具查看错误信息
3. 确认用户名密码正确

### Q: 数据修改不生效
A: 
1. 确保已登录
2. 检查单元格是否在可编辑区域（黄色背景）
3. 查看状态列的提示信息

## 开发技巧

- 修改代码后，Webpack会自动重新编译
- 刷新Excel中的任务窗格查看更改
- 使用浏览器开发者工具调试（F12）
- 查看 `localStorage` 中的日志信息

## 文件说明

- `manifest.xml` - Office加载项清单文件
- `package.json` - 项目依赖和脚本配置
- `webpack.config.js` - Webpack构建配置
- `src/` - 源代码目录
  - `api/` - API调用模块
  - `components/` - React组件
  - `services/` - 业务逻辑服务
  - `utils/` - 工具函数
- `dist/` - 构建输出目录（自动生成）

## 下一步

1. 根据实际API调整凭据编码方式（`src/services/authService.js`）
2. 根据需要添加更多派送人选项（`src/services/orderService.js`）
3. 自定义样式和布局
4. 添加更多功能（如订单导出、统计报表等）

祝开发愉快！

